import{d as a,r as e,o as s,k as o,l,n as r,A as t,t as d,z as i,m as n,G as c,J as u,j as v,B as m,u as p,L as g,q as f}from"./vendor-DG3C2HZs.js";import{G as w}from"./GoogleSignIn-Btcg-XxU.js";import{a as y}from"./api-xqyKR9hB.js";import{_ as b}from"./index-CDvNi4Z9.js";const k={class:"login-view"},h={class:"container"},S={class:"login-container"},_={class:"login-header"},I={class:"form-group"},x={class:"form-group"},j={key:0,class:"error-message"},q={class:"login-actions"},J=["disabled"],U=["disabled"],L={class:"social-login"},N={key:1,class:"demo-accounts"},O=b(a({__name:"LoginView",setup(a){const b=p(),O=g(),B=e({email:"",password:""}),G=e(""),T=e(!1),V=e(!1);async function z(){if(T.value=!0,G.value="",!B.value.email||!B.value.password)return G.value="Пожалуйста, заполните все поля",void(T.value=!1);try{V.value?await async function(){var a,e;try{const a=await y.login({email:B.value.email,password:B.value.password}),e={...a.data.user,token:a.data.token};localStorage.setItem("user",JSON.stringify(e));const s=O.query.redirect||"/";b.push(s)}catch(s){console.error("Login error:",s),(null==(e=null==(a=s.response)?void 0:a.data)?void 0:e.error)?G.value=s.response.data.error:G.value="Ошибка подключения к серверу"}}():(await new Promise((a=>setTimeout(a,500))),function(){const a=localStorage.getItem("demoUsers")||"[]",e=JSON.parse(a).find((a=>a.email===B.value.email&&a.password===B.value.password));if(e){localStorage.setItem("user",JSON.stringify(e));const a=O.query.redirect||"/";b.push(a)}else G.value="Неверный email или пароль"}())}catch(a){console.error("Login error:",a),G.value="Произошла ошибка при входе"}finally{T.value=!1}}function A(){b.push("/register")}return s((async()=>{try{await fetch("undefined/health"),V.value=!0,console.log("✅ Backend доступен - используем онлайн режим")}catch(a){if(V.value=!1,console.log("⚠️ Backend недоступен - используем демо режим"),!localStorage.getItem("demoUsers")){const a=[{email:"worker@example.com",password:"password123",userType:"worker",name:"Иван Рабочий",phone:"+996 555 123456",token:"demo_worker_token"},{email:"employer@example.com",password:"password123",userType:"employer",name:"Алексей Работодатель",phone:"+996 700 654321",token:"demo_employer_token"}];localStorage.setItem("demoUsers",JSON.stringify(a))}}})),(a,e)=>(f(),o("div",k,[l("div",h,[l("div",S,[l("div",_,[e[2]||(e[2]=l("h1",null,"Вход в систему",-1)),e[3]||(e[3]=l("p",null,"Войдите в систему, чтобы получить доступ к вакансиям",-1)),l("div",{class:r(["mode-indicator",{online:V.value,demo:!V.value}])},[l("i",{class:r(V.value?"fas fa-cloud":"fas fa-laptop")},null,2),t(" "+d(V.value?"Онлайн режим":"Демо режим"),1)],2)]),l("form",{onSubmit:i(z,["prevent"]),class:"login-form"},[l("div",I,[e[4]||(e[4]=l("label",{for:"email"},"Email",-1)),c(l("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=a=>B.value.email=a),class:"form-control",placeholder:"Введите ваш email",required:""},null,512),[[u,B.value.email]])]),l("div",x,[e[5]||(e[5]=l("label",{for:"password"},"Пароль",-1)),c(l("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=a=>B.value.password=a),class:"form-control",placeholder:"Введите ваш пароль",required:""},null,512),[[u,B.value.password]])]),G.value?(f(),o("div",j,d(G.value),1)):n("",!0),l("div",q,[l("button",{type:"submit",class:"btn btn-primary",disabled:T.value},d(T.value?"Вход...":"Войти"),9,J),l("button",{type:"button",class:"btn btn-outline",onClick:A,disabled:T.value}," Регистрация ",8,U)]),l("div",L,[e[6]||(e[6]=l("div",{class:"divider"},[l("span",null,"или")],-1)),v(w)]),V.value?n("",!0):(f(),o("div",N,e[7]||(e[7]=[m('<div class="demo-accounts-title" data-v-1290e2da>Тестовые аккаунты:</div><div class="demo-account" data-v-1290e2da><div data-v-1290e2da><strong data-v-1290e2da>Работник:</strong> worker@example.com</div><div data-v-1290e2da><strong data-v-1290e2da>Пароль:</strong> password123</div></div><div class="demo-account" data-v-1290e2da><div data-v-1290e2da><strong data-v-1290e2da>Работодатель:</strong> employer@example.com</div><div data-v-1290e2da><strong data-v-1290e2da>Пароль:</strong> password123</div></div>',3)])))],32)])])]))}}),[["__scopeId","data-v-1290e2da"]]);export{O as default};
